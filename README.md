# Automated-report-generation
from fpdf import FPDF
import pandas as pd

# Step 1: Load and process data
df = pd.read_csv("students.csv")
df['Average'] = df[['Math', 'Science', 'English']].mean(axis=1)

def assign_grade(avg):
    if avg >= 90:
        return 'A+'
    elif avg >= 80:
        return 'A'
    elif avg >= 70:
        return 'B'
    elif avg >= 60:
        return 'C'
    else:
        return 'F'

df['Grade'] = df['Average'].apply(assign_grade)
df['Rank'] = df['Average'].rank(ascending=False, method='min').astype(int)

# Step 2: Define the PDF report class
class PDF(FPDF):
    def header(self):
        self.set_font("Arial", "B", 14)
        self.cell(0, 10, "Annual Examination Report", ln=True, align='C')
        self.set_font("Arial", "", 11)
        self.cell(0, 10, "Academic Year 2024-25", ln=True, align='C')
        self.ln(10)

    def footer(self):
        self.set_y(-15)
        self.set_font("Arial", "I", 9)
        self.cell(0, 10, "Generated by EduReport", align='C')

# Step 3: Create PDF and add student table
pdf = PDF()
pdf.add_page()

pdf.set_font("Arial", "B", 12)
pdf.set_fill_color(200, 220, 255)
pdf.cell(40, 10, "Name", 1, 0, 'C', True)
pdf.cell(30, 10, "Math", 1, 0, 'C', True)
pdf.cell(30, 10, "Science", 1, 0, 'C', True)
pdf.cell(30, 10, "English", 1, 0, 'C', True)
pdf.cell(25, 10, "Average", 1, 0, 'C', True)
pdf.cell(15, 10, "Grade", 1, 0, 'C', True)
pdf.cell(15, 10, "Rank", 1, 1, 'C', True)

pdf.set_font("Arial", "", 12)
for _, row in df.iterrows():
    pdf.cell(40, 10, row["Name"], 1)
    pdf.cell(30, 10, str(row["Math"]), 1)
    pdf.cell(30, 10, str(row["Science"]), 1)
    pdf.cell(30, 10, str(row["English"]), 1)
    pdf.cell(25, 10, f"{row['Average']:.2f}", 1)
    pdf.cell(15, 10, row["Grade"], 1)
    pdf.cell(15, 10, str(row["Rank"]), 1)
    pdf.ln()

# Step 4: Output the report
pdf.output("Student_Grades_Report_India.pdf")
print("âœ… Report generated: Student_Grades_Report_India.pdf")
